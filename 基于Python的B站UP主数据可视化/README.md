# B站UP主数据可视化分析

## 项目简介

这是一个基于Python的B站UP主数据可视化分析项目，通过对B站新榜数据的分析，生成多种可视化图表，帮助用户直观了解B站UP主的各项数据指标和分布情况。

## 功能特点

### 1. 数据处理功能
- 读取B站新榜Excel数据
- 自动清理和转换数据格式（如处理"w"、"亿"等单位）
- 数据类型标准化处理

### 2. 可视化分析功能

#### 基础数据分布
- **性别分布分析**：统计不同性别UP主的分布情况
- **获赞数分析**：UP主获赞数的整体情况和分布特征
- **粉丝数分析**：UP主粉丝数量的分布和统计
- **投币数分析**：UP主视频投币数的分析和分布

#### 分类树状图
- **类型获赞数分布**：以树状图展示各类型UP主的获赞数
- **类型投币数分布**：以树状图展示各类型UP主的投币数
- **类型视频数分布**：以树状图展示各类型UP主的视频数量

#### 词云分析
- **UP主标签词云**：生成UP主标签的词云图，展示热门标签

## 技术栈

- **Python 3.8+**：项目开发语言
- **pandas**：数据处理和分析
- **numpy**：数值计算
- **matplotlib**：基础图表绘制
- **seaborn**：统计数据可视化
- **pyecharts**：交互式图表（树状图）
- **wordcloud**：词云生成
- **jieba**：中文分词
- **PIL**：图像处理

## 安装依赖

在运行项目前，需要安装以下依赖库：

```bash
pip install pandas numpy matplotlib seaborn pyecharts jieba wordcloud pillow openpyxl
```

## 文件结构

```
B站UP主数据可视化/
├── B站新榜_综合指数榜单.xlsx  # B站UP主数据文件
├── cn_stopwords.txt          # 中文停用词表
├── main.py                   # 主程序文件
└── README.md                 # 项目说明文档
```

## 使用方法

### 1. 准备数据

确保`B站新榜_综合指数榜单.xlsx`文件存在于项目目录中，包含以下字段：
- 昵称
- 性别
- 类型
- 获赞数
- 粉丝数
- 投币数
- UP主标签
- 涨粉数
- 播放数

### 2. 运行程序

在项目目录中执行以下命令：

```bash
python main.py
```

### 3. 查看结果

程序运行后将：
- 在控制台输出词云分析的关键词统计
- 生成多个可视化图表窗口
- 保存树状图为HTML文件（如`type_likes_treemap.html`）
- 保存词云图为PNG文件（`tag_wordcloud.png`）

## 核心功能说明

### 1. 数据处理

程序自动处理数据中的格式问题：
- 将字符串格式的数字（如"10w"）转换为整数
- 处理不同量级的单位（如"万"、"亿"）
- 标准化时间格式

### 2. 可视化图表

#### 性别分布
使用饼图展示不同性别UP主的占比情况。

#### 获赞/粉丝/投币数分析
- 趋势图：展示各项指标的整体分布
- 分布图：使用直方图或箱线图展示数据分布特征

#### 树状图
使用pyecharts生成交互式树状图，可在浏览器中查看，支持鼠标悬停查看详细数据。

#### 词云图
使用wordcloud库生成UP主标签词云，展示热门标签，已解决中文乱码问题。

## 注意事项

1. **数据格式**：确保Excel数据格式正确，特别是数字列的单位处理
2. **字体支持**：程序已配置中文字体支持，在macOS系统上使用"STHeiti Medium"字体
3. **依赖版本**：建议使用较新版本的依赖库，特别是pyecharts版本（支持2.0+）
4. **运行环境**：在Jupyter Notebook或普通Python环境中均可运行

## 扩展建议

1. 添加更多类型的可视化图表（如热力图、散点图等）
2. 实现数据动态更新功能
3. 添加交互式界面，支持用户自定义分析维度
4. 增加数据预测和趋势分析功能

## License

MIT License

---

如有问题或建议，欢迎提出！